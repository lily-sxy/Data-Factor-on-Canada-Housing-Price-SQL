(function ClassDefinition(){var d="px",a="hidden",c="aria-expanded",b=null,e={Collapsed:0,Expanded:1},f=function PatientInstructionController(g,e,f,d){var c=".readmore",a=this;a.WP$Controllers$Controller();a.$container=g;if(typeof f!=="undefined"&&f!==b)a._maxHeight=f;if($$WPUtil.IsNullOrEmpty(d)){$$WP.Strings.setDefaultNamespace("Visits");d=$$WP.Strings.get("ViewFullInstructionsButtonText")}e!==b&&e!==undefined&&a.$container.empty().safeAppend($afe.renderTemplate($$WP.Templates.Visits.PatientInstruction,{PatientInstructionsHTML:e,ExpandText:d}));a.$container.find(".readmore a").html(d);a.$readmore=a.$container.find(c);a.$readless=a.$container.find(".readless");a.proxify("_collapseOrExpand","_setupInstructionDiv","_afterTransition","_fitTablesInsideContainer");a.$container.on("click",c,a._collapseOrExpand);a.$container.on("click",".readless a",a._collapseOrExpand);$afe.jq(window).on("resize",a._setupInstructionDiv);$afe.jq(window).on("resize",a._fitTablesInsideContainer);a.$container.on("transitionend webkitTransitionEnd oTransitionEnd",a._afterTransition);a._setupInstructionDiv();a._fitTablesInsideContainer()};f.prototype={$container:b,_state:e.Collapsed,_maxHeight:300,$readmore:b,$readless:b,_afterTransition:function _afterTransition(d){var a=this,g=b;if(d!==b&&d!==undefined){g=d.originalEvent;if(g.propertyName!=="height")return}var f=b;if(a._state===e.Collapsed){a.$readmore.find("a").focus();a.$container.safeAttr(c,"false")}else{f=$afe.jq(window).scrollTop();a.$container.find(".instructionContent").focus();$afe.jq(window).scrollTop(f);a.$container.safeAttr(c,"true")}$$WP.Utilities.UI.MatchColumnHeights()},_setupInstructionDiv:function _setupInstructionDiv(){var b=this;if(b.$container.contentHeight()>b._maxHeight)if(b.$readmore.hasClass(a)&&b.$readless.hasClass(a)){b._state=e.Collapsed;b.$container.safeAttr(c,"false");b._setTabIndexForLinksInside(-1);b.$container.height(b._maxHeight+d);b.$readmore.removeClass(a)}else if(!b.$readless.hasClass(a)){b._state=e.Expanded;b.$container.safeAttr(c,"true");b._setTabIndexForLinksInside(0);b.$container.height("");b.$container.height(b.$container.contentHeight()+d)}},_fitTablesInsideContainer:function fitTablesInsideContainer(){var a="word-break",c,b,d,e;d=this.$container.find(".fmtConv table");e=this.$container.width();for(c=0;c<d.length;c++){b=$afe.jq(d[c]);b.css(a,"");b.width()>e&&b.css(a,"break-all")}},_setTabIndexForLinksInside:function setTabIndexForLinksInside(a){this.$container.find(".instructionContent a").safeAttr("tabindex",a)},_collapseOrExpand:function collapseOrExpand(){var b=this;if(b._state===e.Collapsed){b._state=e.Expanded;b._setTabIndexForLinksInside(0);b.$readmore.addClass(a);b.$readless.removeClass(a);b.$container.height(b.$container.contentHeight()+d)}else{b._state=e.Collapsed;b._setTabIndexForLinksInside(-1);b.$readmore.removeClass(a);b.$readless.addClass(a);b.$container.height(b._maxHeight+d);var c=$afe.select("#header").contentHeight();$$WPUtil.SmoothScrollToElementWithOffset($$WPUtil.ScrollableBody(),b.$container,c,300)}}};$$WPUtil.guaranteeExistence($$WP,"Visits.PatientInstructionController");$$WP.Visits.PatientInstructionController=f;f.extend($$WP.Controllers.Controller,"WP$PatientInstructionController$Controller")})();$$WP.Debug.UnitTest=$$WP.Debug.UnitTest||{};$$WP.Debug.UnitTest.tests=$$WP.Debug.UnitTest.tests||[];$$WP.Debug.UnitTest.tests.push(function UnitTests$PatientInstructionController(){var a;a=$$WP.Debug.UnitTest.assert})